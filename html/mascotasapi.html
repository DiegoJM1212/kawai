<script>
    const API2_URL = 'https://jsonplaceholder.typicode.com'; // Cambié la URL temporalmente

    async function cargarMascotas() {
        try {
            console.log('API2_URL:', API2_URL); // Log the API URL
            const response = await fetch(`${API2_URL}/users`); // Cambié el endpoint a /users para prueba
            console.log('Response status:', response.status); // Log the response status
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const mascotas = await response.json();
            console.log('Mascotas:', mascotas); // Log the received data

            const select = document.getElementById('mascotasSelect');
            select.innerHTML = '<option value="" disabled selected>Selecciona una mascota</option>';

            mascotas.forEach(mascota => {
                const option = document.createElement('option');
                option.value = mascota.id;
                option.textContent = `${mascota.name}`; // Cambié 'name' para probar
                select.appendChild(option);
            });

            select.addEventListener('change', (event) => {
                const mascotaId = event.target.value;
                mostrarMascotaSeleccionada(mascotaId, mascotas);
            });

        } catch (error) {
            console.error('Error detallado al cargar las mascotas:', error);
            mostrarError('Error al cargar las mascotas. Por favor, intente de nuevo más tarde. Detalles: ' + error.message);
        }
    }

    function mostrarMascotaSeleccionada(mascotaId, mascotas) {
        const mascota = mascotas.find(m => m.id === parseInt(mascotaId));
        const contenedor = document.getElementById('mascotaSeleccionada');

        if (mascota) {
            contenedor.innerHTML = `
                <h3>${mascota.name}</h3>  <!-- Cambié a 'name' -->
                <div class="flex flex-col md:flex-row gap-6">
                    <img src="https://via.placeholder.com/150" alt="${mascota.name}" class="w-full md:w-1/2 h-64 object-cover rounded-lg">
                    <div class="flex flex-col justify-between">
                        <div>
                            <p><strong>Tipo:</strong> Mascota ejemplo</p>
                            <p><strong>Estado:</strong> Disponible para adopción</p>
                        </div>
                        <button class="adoptar-btn">Adoptar</button>
                    </div>
                </div>
            `;
        } else {
            contenedor.innerHTML = '<p>Selecciona una mascota para ver más detalles.</p>';
        }
    }

    function mostrarError(mensaje) {
        const errorElement = document.getElementById('error-message');
        errorElement.textContent = mensaje;
        errorElement.style.display = 'block';
        console.error('Error mostrado:', mensaje); // Log the error message
    }

    window.onload = cargarMascotas;
</script>
